function _interopDefault(e){return e&&"object"==typeof e&&"default"in e?e["default"]:e}var $RefParser=_interopDefault(require("json-schema-ref-parser")),jsonpathPlus=require("jsonpath-plus"),Registry=function(){this.data={}};Registry.prototype.unregister=function(e){e?delete this.data[e]:this.data={}},Registry.prototype.register=function(e,t){this.data[e]=t},Registry.prototype.registerMany=function(e){var t=this;Object.keys(e).forEach((function(r){t.data[r]=e[r]}))},Registry.prototype.get=function(e){return this.data[e]},Registry.prototype.list=function(){return this.data};var defaults={defaultInvalidTypeProduct:null,defaultRandExpMax:10,ignoreProperties:[],ignoreMissingRefs:!1,failOnInvalidTypes:!0,failOnInvalidFormat:!0,alwaysFakeOptionals:!1,optionalsProbability:!1,fixedProbabilities:!1,useExamplesValue:!1,useDefaultValue:!1,requiredOnly:!1,minItems:0,maxItems:null,minLength:0,maxLength:null,resolveJsonPath:!1,reuseProperties:!1,fillProperties:!0,replaceEmptyByRandomValue:!1};defaults.random=Math.random;var OptionRegistry=function(e){function t(){e.call(this),this.data=Object.assign({},defaults),this._defaults=defaults}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var r={defaults:{configurable:!0}};return r.defaults.get=function(){return Object.assign({},this._defaults)},Object.defineProperties(t.prototype,r),t}(Registry),registry=new OptionRegistry;function optionAPI(e,t){return"string"==typeof e?void 0!==t?registry.register(e,t):registry.get(e):registry.registerMany(e)}optionAPI.getDefaults=function(){return registry.defaults};var SCALAR_TYPES=["integer","number","string","boolean","null"],ALL_TYPES=["array","object"].concat(SCALAR_TYPES),MOST_NEAR_DATETIME=2524608e6,MIN_INTEGER=-1e8,MAX_INTEGER=1e8,MIN_NUMBER=-100,MAX_NUMBER=100,env={SCALAR_TYPES:SCALAR_TYPES,ALL_TYPES:ALL_TYPES,MIN_NUMBER:MIN_NUMBER,MAX_NUMBER:MAX_NUMBER,MIN_INTEGER:MIN_INTEGER,MAX_INTEGER:MAX_INTEGER,MOST_NEAR_DATETIME:MOST_NEAR_DATETIME};function createCommonjsModule(e,t){return e(t={exports:{}},t.exports),t.exports}var types={ROOT:0,GROUP:1,POSITION:2,SET:3,RANGE:4,REPETITION:5,REFERENCE:6,CHAR:7};const INTS=()=>[{type:types.RANGE,from:48,to:57}],WORDS=()=>[{type:types.CHAR,value:95},{type:types.RANGE,from:97,to:122},{type:types.RANGE,from:65,to:90}].concat(INTS()),WHITESPACE=()=>[{type:types.CHAR,value:9},{type:types.CHAR,value:10},{type:types.CHAR,value:11},{type:types.CHAR,value:12},{type:types.CHAR,value:13},{type:types.CHAR,value:32},{type:types.CHAR,value:160},{type:types.CHAR,value:5760},{type:types.RANGE,from:8192,to:8202},{type:types.CHAR,value:8232},{type:types.CHAR,value:8233},{type:types.CHAR,value:8239},{type:types.CHAR,value:8287},{type:types.CHAR,value:12288},{type:types.CHAR,value:65279}],NOTANYCHAR=()=>[{type:types.CHAR,value:10},{type:types.CHAR,value:13},{type:types.CHAR,value:8232},{type:types.CHAR,value:8233}];var words=()=>({type:types.SET,set:WORDS(),not:!1}),notWords=()=>({type:types.SET,set:WORDS(),not:!0}),ints=()=>({type:types.SET,set:INTS(),not:!1}),notInts=()=>({type:types.SET,set:INTS(),not:!0}),whitespace=()=>({type:types.SET,set:WHITESPACE(),not:!1}),notWhitespace=()=>({type:types.SET,set:WHITESPACE(),not:!0}),anyChar=()=>({type:types.SET,set:NOTANYCHAR(),not:!0}),sets={words:words,notWords:notWords,ints:ints,notInts:notInts,whitespace:whitespace,notWhitespace:notWhitespace,anyChar:anyChar},util=createCommonjsModule((function(e,t){const r={0:0,t:9,n:10,v:11,f:12,r:13};t.strToChars=function(e){return e=e.replace(/(\[\\b\])|(\\)?\\(?:u([A-F0-9]{4})|x([A-F0-9]{2})|(0?[0-7]{2})|c([@A-Z[\\\]^?])|([0tnvfr]))/g,(function(e,t,n,i,a,o,s,u){if(n)return e;var p=t?8:i?parseInt(i,16):a?parseInt(a,16):o?parseInt(o,8):s?"@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^ ?".indexOf(s):r[u],l=String.fromCharCode(p);return/[[\]{}^$.|?*+()]/.test(l)&&(l="\\"+l),l}))},t.tokenizeClass=(e,r)=>{for(var n,i,a=[],o=/\\(?:(w)|(d)|(s)|(W)|(D)|(S))|((?:(?:\\)(.)|([^\]\\]))-(?:\\)?([^\]]))|(\])|(?:\\)?([^])/g;null!=(n=o.exec(e));)if(n[1])a.push(sets.words());else if(n[2])a.push(sets.ints());else if(n[3])a.push(sets.whitespace());else if(n[4])a.push(sets.notWords());else if(n[5])a.push(sets.notInts());else if(n[6])a.push(sets.notWhitespace());else if(n[7])a.push({type:types.RANGE,from:(n[8]||n[9]).charCodeAt(0),to:n[10].charCodeAt(0)});else{if(!(i=n[12]))return[a,o.lastIndex];a.push({type:types.CHAR,value:i.charCodeAt(0)})}t.error(r,"Unterminated character class")},t.error=(e,t)=>{throw new SyntaxError("Invalid regular expression: /"+e+"/: "+t)}})),util_1=util.strToChars,util_2=util.tokenizeClass,util_3=util.error,wordBoundary=()=>({type:types.POSITION,value:"b"}),nonWordBoundary=()=>({type:types.POSITION,value:"B"}),begin=()=>({type:types.POSITION,value:"^"}),end=()=>({type:types.POSITION,value:"$"}),positions={wordBoundary:wordBoundary,nonWordBoundary:nonWordBoundary,begin:begin,end:end},lib=e=>{var t,r,n=0,i={type:types.ROOT,stack:[]},a=i,o=i.stack,s=[],u=t=>{util.error(e,`Nothing to repeat at column ${t-1}`)},p=util.strToChars(e);for(t=p.length;n<t;)switch(r=p[n++]){case"\\":switch(r=p[n++]){case"b":o.push(positions.wordBoundary());break;case"B":o.push(positions.nonWordBoundary());break;case"w":o.push(sets.words());break;case"W":o.push(sets.notWords());break;case"d":o.push(sets.ints());break;case"D":o.push(sets.notInts());break;case"s":o.push(sets.whitespace());break;case"S":o.push(sets.notWhitespace());break;default:/\d/.test(r)?o.push({type:types.REFERENCE,value:parseInt(r,10)}):o.push({type:types.CHAR,value:r.charCodeAt(0)})}break;case"^":o.push(positions.begin());break;case"$":o.push(positions.end());break;case"[":var l;"^"===p[n]?(l=!0,n++):l=!1;var f=util.tokenizeClass(p.slice(n),e);n+=f[1],o.push({type:types.SET,set:f[0],not:l});break;case".":o.push(sets.anyChar());break;case"(":var c={type:types.GROUP,stack:[],remember:!0};"?"===(r=p[n])&&(r=p[n+1],n+=2,"="===r?c.followedBy=!0:"!"===r?c.notFollowedBy=!0:":"!==r&&util.error(e,`Invalid group, character '${r}'`+` after '?' at column ${n-1}`),c.remember=!1),o.push(c),s.push(a),a=c,o=c.stack;break;case")":0===s.length&&util.error(e,`Unmatched ) at column ${n-1}`),o=(a=s.pop()).options?a.options[a.options.length-1]:a.stack;break;case"|":a.options||(a.options=[a.stack],delete a.stack);var h=[];a.options.push(h),o=h;break;case"{":var m,d,y=/^(\d+)(,(\d+)?)?\}/.exec(p.slice(n));null!==y?(0===o.length&&u(n),m=parseInt(y[1],10),d=y[2]?y[3]?parseInt(y[3],10):Infinity:m,n+=y[0].length,o.push({type:types.REPETITION,min:m,max:d,value:o.pop()})):o.push({type:types.CHAR,value:123});break;case"?":0===o.length&&u(n),o.push({type:types.REPETITION,min:0,max:1,value:o.pop()});break;case"+":0===o.length&&u(n),o.push({type:types.REPETITION,min:1,max:Infinity,value:o.pop()});break;case"*":0===o.length&&u(n),o.push({type:types.REPETITION,min:0,max:Infinity,value:o.pop()});break;default:o.push({type:types.CHAR,value:r.charCodeAt(0)})}return 0!==s.length&&util.error(e,"Unterminated group"),i},types_1=types;lib.types=types_1;class SubRange{constructor(e,t){this.low=e,this.high=t,this.length=1+t-e}overlaps(e){return!(this.high<e.low||this.low>e.high)}touches(e){return!(this.high+1<e.low||this.low-1>e.high)}add(e){return new SubRange(Math.min(this.low,e.low),Math.max(this.high,e.high))}subtract(e){return e.low<=this.low&&e.high>=this.high?[]:e.low>this.low&&e.high<this.high?[new SubRange(this.low,e.low-1),new SubRange(e.high+1,this.high)]:e.low<=this.low?[new SubRange(e.high+1,this.high)]:[new SubRange(this.low,e.low-1)]}toString(){return this.low==this.high?this.low.toString():this.low+"-"+this.high}}class DRange{constructor(e,t){this.ranges=[],this.length=0,null!=e&&this.add(e,t)}_update_length(){this.length=this.ranges.reduce((e,t)=>e+t.length,0)}add(e,t){var r=e=>{for(var t=0;t<this.ranges.length&&!e.touches(this.ranges[t]);)t++;for(var r=this.ranges.slice(0,t);t<this.ranges.length&&e.touches(this.ranges[t]);)e=e.add(this.ranges[t]),t++;r.push(e),this.ranges=r.concat(this.ranges.slice(t)),this._update_length()};return e instanceof DRange?e.ranges.forEach(r):(null==t&&(t=e),r(new SubRange(e,t))),this}subtract(e,t){var r=e=>{for(var t=0;t<this.ranges.length&&!e.overlaps(this.ranges[t]);)t++;for(var r=this.ranges.slice(0,t);t<this.ranges.length&&e.overlaps(this.ranges[t]);)r=r.concat(this.ranges[t].subtract(e)),t++;this.ranges=r.concat(this.ranges.slice(t)),this._update_length()};return e instanceof DRange?e.ranges.forEach(r):(null==t&&(t=e),r(new SubRange(e,t))),this}intersect(e,t){var r=[],n=e=>{for(var t=0;t<this.ranges.length&&!e.overlaps(this.ranges[t]);)t++;for(;t<this.ranges.length&&e.overlaps(this.ranges[t]);){var n=Math.max(this.ranges[t].low,e.low),i=Math.min(this.ranges[t].high,e.high);r.push(new SubRange(n,i)),t++}};return e instanceof DRange?e.ranges.forEach(n):(null==t&&(t=e),n(new SubRange(e,t))),this.ranges=r,this._update_length(),this}index(e){for(var t=0;t<this.ranges.length&&this.ranges[t].length<=e;)e-=this.ranges[t].length,t++;return this.ranges[t].low+e}toString(){return"[ "+this.ranges.join(", ")+" ]"}clone(){return new DRange(this)}numbers(){return this.ranges.reduce((e,t)=>{for(var r=t.low;r<=t.high;)e.push(r),r++;return e},[])}subranges(){return this.ranges.map(e=>({low:e.low,high:e.high,length:1+e.high-e.low}))}}var lib$1=DRange;const types$1=lib.types;var randexp=class e{constructor(e,t){if(this._setDefaults(e),e instanceof RegExp)this.ignoreCase=e.ignoreCase,this.multiline=e.multiline,e=e.source;else{if("string"!=typeof e)throw new Error("Expected a regexp or string");this.ignoreCase=t&&-1!==t.indexOf("i"),this.multiline=t&&-1!==t.indexOf("m")}this.tokens=lib(e)}_setDefaults(t){this.max=null!=t.max?t.max:null!=e.prototype.max?e.prototype.max:100,this.defaultRange=t.defaultRange?t.defaultRange:this.defaultRange.clone(),t.randInt&&(this.randInt=t.randInt)}gen(){return this._gen(this.tokens,[])}_gen(e,t){var r,n,i,a,o;switch(e.type){case types$1.ROOT:case types$1.GROUP:if(e.followedBy||e.notFollowedBy)return"";for(e.remember&&e.groupNumber===undefined&&(e.groupNumber=t.push(null)-1),n="",a=0,o=(r=e.options?this._randSelect(e.options):e.stack).length;a<o;a++)n+=this._gen(r[a],t);return e.remember&&(t[e.groupNumber]=n),n;case types$1.POSITION:return"";case types$1.SET:var s=this._expand(e);return s.length?String.fromCharCode(this._randSelect(s)):"";case types$1.REPETITION:for(i=this.randInt(e.min,e.max===Infinity?e.min+this.max:e.max),n="",a=0;a<i;a++)n+=this._gen(e.value,t);return n;case types$1.REFERENCE:return t[e.value-1]||"";case types$1.CHAR:var u=this.ignoreCase&&this._randBool()?this._toOtherCase(e.value):e.value;return String.fromCharCode(u)}}_toOtherCase(e){return e+(97<=e&&e<=122?-32:65<=e&&e<=90?32:0)}_randBool(){return!this.randInt(0,1)}_randSelect(e){return e instanceof lib$1?e.index(this.randInt(0,e.length-1)):e[this.randInt(0,e.length-1)]}_expand(e){if(e.type===lib.types.CHAR)return new lib$1(e.value);if(e.type===lib.types.RANGE)return new lib$1(e.from,e.to);{let t=new lib$1;for(let r=0;r<e.set.length;r++){let n=this._expand(e.set[r]);if(t.add(n),this.ignoreCase)for(let e=0;e<n.length;e++){let r=n.index(e),i=this._toOtherCase(r);r!==i&&t.add(i)}}return e.not?this.defaultRange.clone().subtract(t):this.defaultRange.clone().intersect(t)}}randInt(e,t){return e+Math.floor(Math.random()*(1+t-e))}get defaultRange(){return this._range=this._range||new lib$1(32,126)}set defaultRange(e){this._range=e}static randexp(t,r){var n;return"string"==typeof t&&(t=new RegExp(t,r)),t._randexp===undefined?(n=new e(t,r),t._randexp=n):(n=t._randexp)._setDefaults(t),n.gen()}static sugar(){RegExp.prototype.gen=function(){return e.randexp(this)}}};function getRandomInteger(e,t){return e=void 0===e?env.MIN_INTEGER:e,t=void 0===t?env.MAX_INTEGER:t,Math.floor(optionAPI("random")()*(t-e+1))+e}function _randexp(e){return randexp.prototype.max=optionAPI("defaultRandExpMax"),randexp.prototype.randInt=function(e,t){return e+Math.floor(optionAPI("random")()*(t-e+1))},new randexp(e).gen()}function pick(e){return e[Math.floor(optionAPI("random")()*e.length)]}function shuffle(e){for(var t,r,n=e.length,i=e.slice();n>0;)r=Math.floor(optionAPI("random")()*n),t=i[n-=1],i[n]=i[r],i[r]=t;return i}function getRandom(e,t){return optionAPI("random")()*(t-e)+e}function number(e,t,r,n,i){return void 0===i&&(i=!1),r=void 0===r?env.MIN_NUMBER:r,n=void 0===n?env.MAX_NUMBER:n,(t=void 0===t?n:t)<(e=void 0===e?r:e)&&(t+=e),i?getRandom(e,t):getRandomInteger(e,t)}function by(e){switch(e){case"seconds":return 60*number(0,60);case"minutes":return 612*number(15,50);case"hours":return 36123*number(12,72);case"days":return 86412345*number(7,30);case"weeks":return 604812345*number(4,52);case"months":return 2592012345*number(2,13);case"years":return 31104012345*number(1,20)}}function date(e){if(e)return by(e);var t=new Date,r=number(-1e3,env.MOST_NEAR_DATETIME);return t.setTime(t.getTime()-r),t}var random={pick:pick,date:date,shuffle:shuffle,number:number,randexp:_randexp};function getSubAttribute(e,t){for(var r=t.split(".");r.length;){var n=r.shift();if(!e[n])break;e=e[n]}return e}function hasProperties(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];return t.filter((function(t){return"undefined"!=typeof e[t]})).length>0}function typecast(e,t,r){var n={};switch(e||t.type){case"integer":case"number":if("undefined"!=typeof t.minimum&&(n.minimum=t.minimum),"undefined"!=typeof t.maximum&&(n.maximum=t.maximum),t["enum"]){var i=Math.max(n.minimum||0,0),a=Math.min(n.maximum||Infinity,Infinity);t.exclusiveMinimum&&i===t.minimum&&(i+=t.multipleOf||1),t.exclusiveMaximum&&a===t.maximum&&(a-=t.multipleOf||1),(i||a!==Infinity)&&(t["enum"]=t["enum"].filter((function(e){return e>=i&&e<=a})))}break;case"string":n.minLength=optionAPI("minLength")||0,n.maxLength=optionAPI("maxLength")||Number.MAX_SAFE_INTEGER,"undefined"!=typeof t.minLength&&(n.minLength=Math.max(n.minLength,t.minLength)),"undefined"!=typeof t.maxLength&&(n.maxLength=Math.min(n.maxLength,t.maxLength))}var o=r(n);if(null===o||o===undefined)return null;switch(e||t.type){case"number":o=parseFloat(o);break;case"integer":o=parseInt(o,10);break;case"boolean":o=!!o;break;case"string":o=String(o);for(var s,u=Math.max(n.minLength||0,0),p=Math.min(n.maxLength||Infinity,Infinity);o.length<u&&(s=o,t.pattern?o+=random.randexp(t.pattern):o+=""+random.pick([" ","/","_","-","+","=","@","^"])+o,o!==s););switch(o.length>p&&(o=o.substr(0,p)),t.format){case"date-time":case"datetime":o=new Date(o).toISOString().replace(/([0-9])0+Z$/,"$1Z");break;case"date":o=new Date(o).toISOString().substr(0,10);break;case"time":o=new Date("1969-01-01 "+o).toISOString().substr(11)}}return o}function merge(e,t){return Object.keys(t).forEach((function(r){"object"!=typeof t[r]||null===t[r]?e[r]=t[r]:Array.isArray(t[r])?(e[r]=e[r]||[],t[r].forEach((function(t){Array.isArray(e[r])&&-1===e[r].indexOf(t)&&e[r].push(t)}))):"object"!=typeof e[r]||null===e[r]||Array.isArray(e[r])?e[r]=merge({},t[r]):e[r]=merge(e[r],t[r])})),e}function clone(e,t){if(void 0===t&&(t=new Map),!e||"object"!=typeof e)return e;if(t.has(e))return t.get(e);if(Array.isArray(e)){var r=[];return t.set(e,r),r.push.apply(r,e.map((function(e){return clone(e,t)}))),r}var n={};return t.set(e,n),Object.keys(e).reduce((function(r,n){return r[n]=clone(e[n],t),r}),n)}function short(e){var t=JSON.stringify(e),r=JSON.stringify(e,null,2);return t.length>400?r.substr(0,400)+"...":r}function anyValue(){return random.pick([!1,!0,null,-1,NaN,Math.PI,Infinity,undefined,[],{},Math.random(),Math.random().toString(36).substr(2)])}function notValue(e,t){var r=merge({},t);if("undefined"!=typeof e.minimum&&(r.maximum=e.minimum,r.exclusiveMaximum=!0),"undefined"!=typeof e.maximum&&(r.minimum=e.maximum>r.maximum?0:e.maximum,r.exclusiveMinimum=!0),"undefined"!=typeof e.minLength&&(r.maxLength=e.minLength),"undefined"!=typeof e.maxLength&&(r.minLength=e.maxLength>r.maxLength?0:e.maxLength),e.type)r.type=random.pick(env.SCALAR_TYPES.filter((function(t){return(Array.isArray(e.type)?e.type:[e.type]).every((function(e){return"number"===t||"integer"===t?"number"!==e&&"integer"!==e:t!==e}))})));else if(e["enum"]){var n;do{n=anyValue()}while(-1!==e["enum"].indexOf(n));r["enum"]=[n]}return e.required&&r.properties&&e.required.forEach((function(e){delete r.properties[e]})),r}function validate(e,t){return!t.every((function(t){return"undefined"!=typeof t.minimum&&e>=t.minimum||"undefined"!=typeof t.maximum&&e<=t.maximum}))}function isKey(e){return-1!==["enum","const","default","examples","required","definitions"].indexOf(e)}function omitProps(e,t){var r={};return Object.keys(e).forEach((function(n){-1===t.indexOf(n)&&(Array.isArray(e[n])?r[n]=e[n].slice():r[n]=e[n]instanceof Object?merge({},e[n]):e[n])})),r}function template(e,t){return Array.isArray(e)?e.map((function(e){return template(e,t)})):("string"==typeof e&&(e=e.replace(/#\{([\w.-]+)\}/g,(function(e,r){return t[r]}))),e)}var utils={getSubAttribute:getSubAttribute,hasProperties:hasProperties,omitProps:omitProps,typecast:typecast,merge:merge,clone:clone,short:short,notValue:notValue,anyValue:anyValue,validate:validate,isKey:isKey,template:template};function proxy(e){return function(t,r,n,i){var a=t,o=[];"object"==typeof t&&(a=Object.keys(t)[0],Array.isArray(t[a])?o=t[a]:o.push(t[a]));for(var s=a.split("."),u=e();s.length>1;)u=u[s.shift()];return"function"==typeof(t="object"==typeof u?u[s[0]]:u)&&(t=t.apply(u,o.map((function(e){return utils.template(e,i)})))),"[object Object]"==={}.toString.call(t)&&Object.keys(t).forEach((function(e){if("function"==typeof t[e])throw new Error("Cannot resolve value for '"+n+": "+a+"', given: "+t)})),t}}var Container=function(){this.registry={},this.support={}};Container.prototype.reset=function(e){e?(delete this.registry[e],delete this.support[e]):(this.registry={},this.support={})},Container.prototype.extend=function(e,t){var r=this;this.registry[e]=t(this.registry[e]),this.support[e]||(this.support[e]=proxy((function(){return r.registry[e]})))},Container.prototype.define=function(e,t){this.support[e]=t},Container.prototype.get=function(e){if("undefined"==typeof this.registry[e])throw new ReferenceError("'"+e+"' dependency doesn't exist.");return this.registry[e]},Container.prototype.wrap=function(e){for(var t=this,r=Object.keys(e),n={},i=r.length,a=function(){var a=r[i].replace(/^x-/,""),o=t.support[a];if("function"==typeof o)return Object.defineProperty(e,"generate",{configurable:!1,enumerable:!1,writable:!1,value:function(t){return o.call(n,e[r[i]],e,r[i],t)}}),"break"};i--;){if("break"===a())break}return e};var registry$1=new Registry;function formatAPI(e,t){if(void 0===e)return registry$1.list();if("string"==typeof e)if("function"==typeof t)registry$1.register(e,t);else{if(null!==t&&!1!==t)return registry$1.get(e);registry$1.unregister(e)}else registry$1.registerMany(e)}var ParseError=function(e){function t(t,r){e.call(this),e.captureStackTrace&&e.captureStackTrace(this,this.constructor),this.name="ParseError",this.message=t,this.path=r}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(Error),inferredProperties={array:["additionalItems","items","maxItems","minItems","uniqueItems"],integer:["exclusiveMaximum","exclusiveMinimum","maximum","minimum","multipleOf"],object:["additionalProperties","dependencies","maxProperties","minProperties","patternProperties","properties","required"],string:["maxLength","minLength","pattern","format"]};inferredProperties.number=inferredProperties.integer;var subschemaProperties=["additionalItems","items","additionalProperties","dependencies","patternProperties","properties"];function matchesType(e,t,r){return Object.keys(e).filter((function(e){var n=subschemaProperties.indexOf(t)>-1;return!(!(r.indexOf(e)>-1)||n)})).length>0}function inferType(e,t){for(var r=Object.keys(inferredProperties),n=0;n<r.length;n+=1){var i=r[n];if(matchesType(e,t[t.length-1],inferredProperties[i]))return i}}function booleanGenerator(){return optionAPI("random")()>.5}var booleanType=booleanGenerator;function nullGenerator(){return null}var nullType=nullGenerator;function unique(e,t,r,n,i,a){var o=[],s=[];function u(e){var t=JSON.stringify(e);return-1===s.indexOf(t)&&(s.push(t),o.push(e),!0)}t.forEach(u);for(var p=100;o.length!==t.length&&(u(a(r.items||n,e,i))||(p-=1),p););return o}function arrayType(e,t,r,n){var i=[];if(!e.items&&!e.additionalItems){if(utils.hasProperties(e,"minItems","maxItems","uniqueItems"))throw new ParseError("missing items for "+utils.short(e),t);return i}if(Array.isArray(e.items))return e.items.map((function(e,i){var a=t.concat(["items",i]);return n(e,a,r)}));var a=e.minItems,o=e.maxItems;optionAPI("minItems")&&(a=o?Math.min(optionAPI("minItems"),o):optionAPI("minItems")),optionAPI("maxItems")&&((o=a?Math.min(optionAPI("maxItems"),a):optionAPI("maxItems"))&&o>optionAPI("maxItems")&&(o=optionAPI("maxItems")),a&&a>optionAPI("maxItems")&&(a=o));var s=!0===optionAPI("alwaysFakeOptionals")?1:optionAPI("optionalsProbability"),u=optionAPI("alwaysFakeOptionals")||optionAPI("fixedProbabilities")||!1,p=random.number(a,o,1,5);!1!==s&&(p=Math.max(u?Math.round((o||p)*s):Math.abs(random.number(a,o)*s),a||0));for(var l="object"==typeof e.additionalItems?e.additionalItems:{},f=i.length;f<p;f+=1){var c=t.concat(["items",f]),h=n(e.items||l,c,r);i.push(h)}return e.uniqueItems?unique(t.concat(["items"]),i,e,l,r,n):i}function numberType(e){var t="undefined"==typeof e.minimum?env.MIN_INTEGER:e.minimum,r="undefined"==typeof e.maximum?env.MAX_INTEGER:e.maximum,n=e.multipleOf;if(n&&(r=Math.floor(r/n)*n,t=Math.ceil(t/n)*n),e.exclusiveMinimum&&t===e.minimum&&(t+=n||1),e.exclusiveMaximum&&r===e.maximum&&(r-=n||1),t>r)return NaN;if(n){if(-1===String(n).indexOf(".")){for(var i=random.number(Math.floor(t/n),Math.floor(r/n))*n;i<t;)i+=e.multipleOf;return i}var a,o,s=(r-t)/n;do{o=(a=random.number(0,s)*n)/n%1}while(0!==o);return t+a}return random.number(t,r,undefined,undefined,!0)}function integerType(e){return numberType(Object.assign({multipleOf:1},e))}var LIPSUM_WORDS="Lorem ipsum dolor sit amet consectetur adipisicing elit sed do eiusmod tempor incididunt ut labore\net dolore magna aliqua Ut enim ad minim veniam quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea\ncommodo consequat Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla\npariatur Excepteur sint occaecat cupidatat non proident sunt in culpa qui officia deserunt mollit anim id est\nlaborum".split(/\W/);function wordsGenerator(e){return random.shuffle(LIPSUM_WORDS).slice(0,e)}var anyType={type:["string","number","integer","boolean"]};function objectType(e,t,r,n){var i={},a=e.properties||{},o=e.patternProperties||{},s="boolean"==typeof e.required?[]:(e.required||[]).slice(),u=!1!==e.additionalProperties,p=Object.keys(a),l=Object.keys(o),f=p.concat(l).reduce((function(e,t){return-1===s.indexOf(t)&&e.push(t),e}),[]),c=s.concat(f),h=u&&!0===e.additionalProperties?anyType:e.additionalProperties;if(!u&&0===p.length&&0===l.length&&utils.hasProperties(e,"minProperties","maxProperties","dependencies","required"))return null;if(!0===optionAPI("requiredOnly"))return s.forEach((function(e){a[e]&&(i[e]=a[e])})),n(i,t.concat(["properties"]),r,e);var m=!0===optionAPI("alwaysFakeOptionals")?1:optionAPI("optionalsProbability"),d=optionAPI("alwaysFakeOptionals")||optionAPI("fixedProbabilities")||!1,y=optionAPI("ignoreProperties")||[],g=Math.max(e.minProperties||0,s.length),v=e.maxProperties||c.length+(u?random.number(1,5):0),b=Math.max(0,c.length-g);1!==c.length||s.length||(b=random.number(b,c.length+(c.length-g))),!1!==m&&(b=!0===d?Math.round(g-s.length+m*(c.length-g)):random.number(g-s.length,m*(c.length-g)));var A=random.shuffle(f).slice(0,b),I=f.filter((function(e){return-1!==A.indexOf(e)})),x=!1!==m?v:random.number(0,v),E=s.concat(I.slice(0,x)),R=[];if(e.dependencies&&(Object.keys(e.dependencies).forEach((function(t){var r=e.dependencies[t];-1!==E.indexOf(t)&&(Array.isArray(r)?r.forEach((function(e){-1===E.indexOf(e)&&E.push(e)})):R.push(r))})),R.length))return delete e.dependencies,n({allOf:R.concat(e)},t.concat(["properties"]),r,e);var P=[];E.forEach((function(e){for(var t=0;t<y.length;t+=1)if(y[t]instanceof RegExp&&y[t].test(e)||"string"==typeof y[t]&&y[t]===e||"function"==typeof y[t]&&y[t](a[e],e))return void P.push(e);var r;if(!1===h&&-1!==s.indexOf(e)&&(i[e]=a[e]),a[e]&&(i[e]=a[e]),l.forEach((function(t){e.match(new RegExp(t))&&(r=!0,i[e]?utils.merge(i[e],o[t]):i[random.randexp(e)]=o[t])})),!r){var n=o[e]||h;n&&!1!==h&&(i[o[e]?random.randexp(e):e]=a[e]||n)}}));var O,w=optionAPI("fillProperties"),T=optionAPI("reuseProperties"),M=Object.keys(i).length+(w?0:P.length);function _(e){var t;do{if(!e.length)break;t=e.shift()}while(i[t]);return t}for(;w&&(l.length||u)&&!(M>=g);){if(u)if(T&&p.length-M>g){var k=0,S=void 0;do{if((k+=1)>1e3)break;S=_(s)||random.pick(p)}while("undefined"!=typeof i[S]);"undefined"==typeof i[S]&&(i[S]=a[S],M+=1)}else if(l.length&&!h){var N=random.pick(l),j=random.randexp(N);i[j]||(i[j]=o[N],M+=1)}else{var C=_(s)||wordsGenerator(1)+(O=void 0,random.randexp("_?[_a-f\\d]{1,3}"+(O?"\\$?":"")));i[C]||(i[C]=h||anyType,M+=1)}for(var $=0;M<g&&$<l.length;$+=1){var L=l[$],G=random.randexp(L);i[G]||(i[G]=o[L],M+=1)}}if(0===s.length&&(!u||!1===m))for(var D=random.number(g,v);M<D;){var H=_(p);H&&(i[H]=a[H]),M+=1}return n(i,t.concat(["properties"]),r,e)}function produce(){return wordsGenerator(random.number(1,5)).join(" ")}function thunkGenerator(e,t){void 0===e&&(e=0),void 0===t&&(t=140);for(var r=Math.max(0,e),n=random.number(r,t),i=produce();i.length<r;)i+=produce();return i.length>n&&(i=i.substr(0,n)),i}function ipv4Generator(){return[0,0,0,0].map((function(){return random.number(0,255)})).join(".")}function dateTimeGenerator(){return random.date().toISOString()}function dateGenerator(){return dateTimeGenerator().slice(0,10)}function timeGenerator(){return dateTimeGenerator().slice(11)}var FRAGMENT="[a-zA-Z][a-zA-Z0-9+-.]*",URI_PATTERN="https?://{hostname}(?:"+FRAGMENT+")+",PARAM_PATTERN="(?:\\?([a-z]{1,7}(=\\w{1,5})?&){0,3})?",regexps={email:"[a-zA-Z\\d][a-zA-Z\\d-]{1,13}[a-zA-Z\\d]@{hostname}",hostname:"[a-zA-Z]{1,33}\\.[a-z]{2,4}",ipv6:"[a-f\\d]{4}(:[a-f\\d]{4}){7}",uri:URI_PATTERN,slug:"[a-zA-Z\\d_-]+","uri-reference":""+URI_PATTERN+PARAM_PATTERN,"uri-template":URI_PATTERN.replace("(?:","(?:/\\{[a-z][:a-zA-Z0-9-]*\\}|"),"json-pointer":"(/(?:"+FRAGMENT.replace("]*","/]*")+"|~[01]))+",uuid:"^[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$"};regexps.iri=regexps["uri-reference"],regexps["iri-reference"]=regexps["uri-reference"],regexps["idn-email"]=regexps.email,regexps["idn-hostname"]=regexps.hostname;var ALLOWED_FORMATS=new RegExp("\\{("+Object.keys(regexps).join("|")+")\\}");function coreFormatGenerator(e){return random.randexp(regexps[e]).replace(ALLOWED_FORMATS,(function(e,t){return random.randexp(regexps[t])}))}function generateFormat(e,t){var r=formatAPI(e.format);if("function"==typeof r)return r(e);switch(e.format){case"date-time":case"datetime":return dateTimeGenerator();case"date":return dateGenerator();case"time":return timeGenerator();case"ipv4":return ipv4Generator();case"regex":return".+?";case"email":case"hostname":case"ipv6":case"uri":case"uri-reference":case"iri":case"iri-reference":case"idn-email":case"idn-hostname":case"json-pointer":case"slug":case"uri-template":case"uuid":return coreFormatGenerator(e.format);default:if(void 0===r){if(optionAPI("failOnInvalidFormat"))throw new Error("unknown registry key "+utils.short(e.format));return t()}throw new Error("unsupported format '"+e.format+"'")}}function stringType(e){return utils.typecast("string",e,(function(t){return e.format?generateFormat(e,(function(){return thunkGenerator(t.minLength,t.maxLength)})):e.pattern?random.randexp(e.pattern):thunkGenerator(t.minLength,t.maxLength)}))}var typeMap={boolean:booleanType,"null":nullType,array:arrayType,integer:integerType,number:numberType,object:objectType,string:stringType};function traverse(e,t,r,n){if(e=r(e,null,t)){if("properties"!==t[t.length-1]){if(optionAPI("useExamplesValue")&&Array.isArray(e.examples)){var i=e.examples.concat("default"in e?[e["default"]]:[]);return utils.typecast(null,e,(function(){return random.pick(i)}))}if(optionAPI("useDefaultValue")&&"default"in e&&(""!==e["default"]||!optionAPI("replaceEmptyByRandomValue")))return e["default"];if("template"in e)return utils.template(e.template,n)}if(e.not&&"object"==typeof e.not&&(e=utils.notValue(e.not,utils.omitProps(e,["not"]))).type&&"object"===e.type)return traverse(e,t.concat(["not"]),r,n);if("const"in e)return e["const"];if(Array.isArray(e["enum"]))return utils.typecast(null,e,(function(){return random.pick(e["enum"])}));if("function"==typeof e.thunk)return traverse(e.thunk(n),t,r);if("function"==typeof e.generate)return utils.typecast(null,e,(function(){return e.generate(n)}));if(e.jsonPath)return e;var a=e.type;if(Array.isArray(a)?a=random.pick(a):void 0===a&&(a=inferType(e,t)||a)&&(e.type=a),"string"==typeof a){if(!typeMap[a]){if(optionAPI("failOnInvalidTypes"))throw new ParseError("unknown primitive "+utils.short(a),t.concat(["type"]));return optionAPI("defaultInvalidTypeProduct")}try{return typeMap[a](e,t,r,traverse)}catch(s){if("undefined"==typeof s.path)throw new ParseError(s.stack,t);throw s}}var o={};return Array.isArray(e)&&(o=[]),Object.keys(e).forEach((function(n){"object"==typeof e[n]&&"definitions"!==n?o[n]=traverse(e[n],t.concat([n]),r,o):o[n]=e[n]})),o}}function isEmpty(e){return"[object Object]"==={}.toString.call(e)&&!Object.keys(e).length}function pick$1(e){return Array.isArray(e)?random.pick(e):e}function cycle(e,t){if(!Array.isArray(e))return e;var r=t?e.pop():e.shift();return t?e.unshift(r):e.push(r),r}function clean(e,t){return e&&"object"==typeof e?Array.isArray(e)?e.map((function(e){return clean(e,!0)})).filter((function(e){return void 0!==e})):(Object.keys(e).forEach((function(t){if(isEmpty(e[t]))delete e[t];else{var r=clean(e[t]);isEmpty(r)||(e[t]=r)}})),!Object.keys(e).length&&t?undefined:e):e}function resolve(e,t,r,n){if(!e||"object"!=typeof e)return e;if(r||(r={}),t||(t=e),Array.isArray(e))return e.map((function(e){return resolve(e,t,r,n)}));if(e.jsonPath){var i="object"!=typeof e.jsonPath?{path:e.jsonPath}:e.jsonPath;i.group=e.group||i.group||n,i.cycle=e.cycle||i.cycle||!1,i.reverse=e.reverse||i.reverse||!1,i.count=e.count||i.count||1;var a=i.group+"__"+i.path;return r[a]||(i.count>1?r[a]=jsonpathPlus.JSONPath(i.path,t).slice(0,i.count):r[a]=jsonpathPlus.JSONPath(i.path,t)),i.cycle||i.reverse?cycle(r[a],i.reverse):pick$1(r[a])}return Object.keys(e).forEach((function(n){e[n]=resolve(e[n],t,r,n)})),e}function run(e,t,r){var n,i=0,a=optionAPI("refDepthMin")||0,o=optionAPI("refDepthMax")||3;try{var s=traverse(utils.clone(t),[],(function u(s,p,l){if(null===s||s===undefined)return null;if("function"==typeof s.generate)return s;if("string"==typeof(s.$id||s.id)&&(delete s.id,delete s.$id,delete s.$schema),"string"==typeof s.$ref){var f,c=random.number(Math.min(a,o),Math.max(a,o))-1;if("#"===s.$ref||n===s.$ref&&++i>c)return delete s.$ref,s;if(n=s.$ref,-1===s.$ref.indexOf("#/")&&(f=e[s.$ref]||null),0===s.$ref.indexOf("#/definitions/")&&(f=t.definitions[s.$ref.split("#/definitions/")[1]]||null),void 0!==f){if(!f&&!0!==optionAPI("ignoreMissingRefs"))throw new Error("Reference not found: "+s.$ref);utils.merge(s,f||{})}return delete s.$ref,s}if(Array.isArray(s.allOf)){var h=s.allOf;delete s.allOf,h.forEach((function(e){var t=u(e,null,l);utils.merge(s,"function"==typeof t.thunk?t.thunk(s):t)}))}if(Array.isArray(s.oneOf||s.anyOf)){var m=s.oneOf||s.anyOf;return s["enum"]&&s.oneOf&&(s["enum"]=s["enum"].filter((function(e){return utils.validate(e,m)}))),{thunk:function(e){var t=utils.omitProps(s,["anyOf","oneOf"]),r=random.pick(m);return utils.merge(t,r),m.forEach((function(n){n.required&&n!==r&&n.required.forEach((function(r){t.properties&&t.required&&!t.required.includes(r)&&delete t.properties[r],e&&e.properties&&delete e.properties[r]}))})),t}}}if(Object.keys(s).forEach((function(e){!Array.isArray(s[e])&&"object"!=typeof s[e]||utils.isKey(e)||(s[e]=u(s[e],e,l.concat(e)))})),l){var d=l[l.length-1];if("properties"===d||"items"===d)return s}return r.wrap(s)}));return optionAPI("resolveJsonPath")?resolve(clean(s)):clean(s)}catch(u){throw u.path?new Error(u.message+" in /"+u.path.join("/")):u}}var container=new Container;function setupKeywords(){container.define("pattern",random.randexp),container.define("autoIncrement",(function(e,t){if(!this.offset){var r=t.minimum||1,n=r+env.MAX_NUMBER,i=e.initialOffset||t.initialOffset;this.offset=i||random.number(r,n)}return!0===e?this.offset++:t})),container.define("sequentialDate",(function(e,t){if(this.now||(this.now=random.date()),e){if(t=this.now.toISOString(),-1===["seconds","minutes","hours","days","weeks","months","years"].indexOf(e=!0===e?"days":e))throw new Error("Unsupported increment by "+utils.short(e));this.now.setTime(this.now.getTime()+random.date(e))}return t}))}function getRefs(e){var t={};return Array.isArray(e)?e.forEach((function(e){t[e.$id||e.id]=e})):t=e||{},t}var jsf=function(e,t,r){return jsf.generate(e,t)};jsf.generate=function(e,t){return run(getRefs(t),e,container)},jsf.resolve=function(e,t,r){"string"==typeof t&&(r=t,t={}),r=(r=r||("undefined"!=typeof process?process.cwd():"")).replace(/\/+$/,"")+"/";var n=getRefs(t),i={order:300,canRead:!0,read:function(e,t){try{t(null,n[e.url]||n[e.url.split("/").pop()])}catch(r){t(r)}}};return $RefParser.dereference(r,e,{resolve:{file:{order:100},http:{order:200},fixedRefs:i},dereference:{circular:"ignore"}}).then((function(e){return run(n,e,container)}))},setupKeywords(),jsf.format=formatAPI,jsf.option=optionAPI,jsf.random=random,jsf.extend=function(e,t){return container.extend(e,t),jsf},jsf.define=function(e,t){return container.define(e,t),jsf},jsf.reset=function(e){return container.reset(e),setupKeywords(),jsf},jsf.locate=function(e){return container.get(e)},"undefined"!=typeof VERSION&&(jsf.version=VERSION),module.exports=jsf;